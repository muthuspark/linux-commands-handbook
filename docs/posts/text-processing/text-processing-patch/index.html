<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muthukrishnan">
<meta name="dcterms.date" content="2024-04-19">
<meta name="description" content="Explore Linux commands. Free knowledge sharing under MIT License.">

<title>patch – Linux Commands Handbook</title>
<style>
html {
  color: #1a1a1a;
  background-color: #fdfdfd;
}
body {
  margin: 0 auto;
  max-width: 36em;
  padding-left: 50px;
  padding-right: 50px;
  padding-top: 50px;
  padding-bottom: 50px;
  hyphens: auto;
  overflow-wrap: break-word;
  text-rendering: optimizeLegibility;
  font-kerning: normal;
}
@media (max-width: 600px) {
  body {
    font-size: 0.9em;
    padding: 12px;
  }
  h1 {
    font-size: 1.8em;
  }
}
@media print {
  html {
    background-color: white;
  }
  body {
    background-color: transparent;
    color: black;
    font-size: 12pt;
  }
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  h2, h3, h4 {
    page-break-after: avoid;
  }
}
p {
  margin: 1em 0;
}
a {
  color: #1a1a1a;
}
a:visited {
  color: #1a1a1a;
}
img {
  max-width: 100%;
}
svg {
  height; auto;
  max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
  margin-top: 1.4em;
}
h5, h6 {
  font-size: 1em;
  font-style: italic;
}
h6 {
  font-weight: normal;
}
ol, ul {
  padding-left: 1.7em;
  margin-top: 1em;
}
li > ol, li > ul {
  margin-top: 0;
}
ul > li:not(:has(> p)) > ul,
ol > li:not(:has(> p)) > ul,
ul > li:not(:has(> p)) > ol,
ol > li:not(:has(> p)) > ol {
  margin-bottom: 0;
}
ul > li:not(:has(> p)) > ul > li:has(> p),
ol > li:not(:has(> p)) > ul > li:has(> p),
ul > li:not(:has(> p)) > ol > li:has(> p),
ol > li:not(:has(> p)) > ol > li:has(> p) {
  margin-top: 1rem;
}
blockquote {
  margin: 1em 0 1em 1.7em;
  padding-left: 1em;
  border-left: 2px solid #e6e6e6;
  color: #606060;
}
code {
  font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
  font-size: 85%;
  margin: 0;
  hyphens: manual;
}
pre {
  margin: 1em 0;
  overflow: auto;
}
pre code {
  padding: 0;
  overflow: visible;
  overflow-wrap: normal;
}
.sourceCode {
 background-color: transparent;
 overflow: visible;
}
hr {
  background-color: #1a1a1a;
  border: none;
  height: 1px;
  margin: 1em 0;
}
table {
  margin: 1em 0;
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-variant-numeric: lining-nums tabular-nums;
}
table caption {
  margin-bottom: 0.75em;
}
tbody {
  margin-top: 0.5em;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
}
th {
  border-top: 1px solid #1a1a1a;
  padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
  padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
  margin-bottom: 4em;
  text-align: center;
}
#TOC li {
  list-style: none;
}
#TOC ul {
  padding-left: 1.3em;
}
#TOC > ul {
  padding-left: 0;
}
#TOC a:not(:hover) {
  text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../../favicon.ico" rel="icon">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T5MFF1D7PZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-T5MFF1D7PZ', { 'anonymize_ip': true});
</script>
<link rel="icon" type="image/x-icon" href="../../../favicon.ico">
<meta property="og:title" content="patch – Linux Commands Handbook">
<meta property="og:site_name" content="Linux Commands Handbook">
</head><body><div class="navigation-header">
    <nav>
        <div>
            <div class="logo">
                <a href="../../../" aria-label="Home">
                    <span>Linux Commands Handbook - Home</span>
                </a>
            </div>
            <div class="nav-menu">
                <ul>
                    <li>
                        <a href="../../../about.html">
                            <span class="menu-text">About</span>
                        </a>
                    </li>
                    <li> 
                        <a href="https://github.com/muthuspark" target="_blank">
                            <span class="menu-text">Github</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/krimuthu" target="_blank">
                            <span class="menu-text">Linkedin</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<link rel="stylesheet" href="../../../styles.css">





<header id="title-block-header">
<h1 class="title">patch</h1>

<p class="date">2024-04-19</p>
</header>


<h2 id="understanding-the-basics-of-patch">Understanding the Basics of <code>patch</code></h2>
<p>The <code>patch</code> command reads a set of instructions from a <em>patch file</em> (typically with a <code>.patch</code> extension) and applies those instructions to one or more target files. These instructions detail additions, deletions, and modifications to the original file’s content. Patch files are often generated using tools like <code>diff</code>, which compares two versions of a file and produces a patch representing the differences.</p>
<h2 id="key-patch-command-options">Key <code>patch</code> Command Options</h2>
<p>Before diving into examples, let’s familiarize ourselves with some frequently used <code>patch</code> options:</p>
<ul>
<li><p><strong><code>-p&lt;number&gt;</code>:</strong> This option strips leading directory components from filenames within the patch file. For instance, <code>-p1</code> removes the first directory level. This is extremely useful when dealing with patches generated from source code trees.</p></li>
<li><p><strong><code>-i &lt;patchfile&gt;</code>:</strong> Specifies the patch file to apply. This is often the most important option.</p></li>
<li><p><strong><code>-b</code>:</strong> Creates backup copies of the original files before applying the patch. Highly recommended to avoid data loss.</p></li>
<li><p><strong><code>-f</code>:</strong> Forces the application of the patch even if there are warnings or potential conflicts. Use with caution!</p></li>
<li><p><strong><code>--dry-run</code> or <code>-n</code>:</strong> Performs a dry run, showing what changes would be made without actually modifying the files. This is for previewing the impact of a patch.</p></li>
</ul>
<h2 id="practical-code-examples">Practical Code Examples</h2>
<p>Let’s illustrate <code>patch</code>’s functionality with some concrete examples. Assume we have a file named <code>original.txt</code> with the following content:</p>
<pre><code>This is the original line 1.
This is the original line 2.
This is the original line 3.</code></pre>
<p><strong>Example 1: Applying a Simple Patch</strong></p>
<p>First, let’s create a patch file named <code>mypatch.patch</code> using the <code>diff</code> command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> <span class="at">-u</span> original.txt original_modified.txt <span class="op">&gt;</span> mypatch.patch</span></code></pre></div>
<p>Assuming <code>original_modified.txt</code> contains:</p>
<pre><code>This is the original line 1.
This is a modified line 2.
This is the original line 3.
This is a new line 4.</code></pre>
<p>Now, apply the patch:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">patch</span> <span class="at">-i</span> mypatch.patch original.txt</span></code></pre></div>
<p>This will modify <code>original.txt</code> to reflect the changes in <code>mypatch.patch</code>.</p>
<p><strong>Example 2: Using <code>-p</code> to Strip Paths</strong></p>
<p>Suppose your patch file contains paths relative to a source code directory. Let’s say <code>mypatch.patch</code> looks like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode diff"><code class="sourceCode diff"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--- a/src/myprogram.c   2023-10-27 10:30:00.000000000 +0200</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ b/src/myprogram.c   2023-10-27 10:31:00.000000000 +0200</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -10,7 +10,7 @@</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> int main() {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  printf("Hello, ");</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  printf("world!\n");</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">- printf("This is the old line.\n");</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="va">+ printf("This is the new line.\n");</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  return 0;</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
<p>To apply this patch to <code>myprogram.c</code> located in the current directory, we’d use:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">patch</span> <span class="at">-p1</span> <span class="at">-i</span> mypatch.patch myprogram.c </span></code></pre></div>
<p>The <code>-p1</code> removes the leading <code>src/</code> from the filename within the patch, allowing for correct application.</p>
<p><strong>Example 3: Utilizing <code>-b</code> and <code>--dry-run</code></strong></p>
<p>To apply the patch safely and preview changes, use:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">patch</span> <span class="at">-b</span> <span class="at">-n</span> <span class="at">-i</span> mypatch.patch original.txt</span></code></pre></div>
<p>This will create a backup (e.g., <code>original.txt.orig</code>) and show the changes without modifying the original file. Remove the <code>-n</code> flag to actually apply the patch after reviewing the dry run output.</p>
<p><strong>Example 4: Handling Conflicts</strong></p>
<p>If <code>patch</code> encounters conflicting changes between the patch and the target file, it will usually halt and indicate the conflict. You’ll need to manually resolve these conflicts by editing the affected file before running <code>patch</code> again. This is often a more involved process, requiring careful consideration of the conflicting changes. Careful review and understanding of your changes is essential before proceeding.</p>


<footer>
    <p>© 2024 · Content on this site is licensed under the <a href="https://opensource.org/licenses/MIT">MIT License</a> · Built with ♥</p>
</footer>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3609399560636561" crossorigin="anonymous"></script>




</body></html>